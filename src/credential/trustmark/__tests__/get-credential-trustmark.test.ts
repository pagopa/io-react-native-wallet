import { deleteKey, generate } from "@pagopa/io-react-native-crypto";
import { decode, type CryptoContext } from "@pagopa/io-react-native-jwt";
import { getCredentialTrustmark } from "../get-credential-trustmark";

// Wallet Instance Attestation
const walletInstanceAttestation =
  "eyJ0cnVzdF9jaGFpbiI6WyJleUowZVhBaU9pSmxiblJwZEhrdGMzUmhkR1Z0Wlc1MEsycDNkQ0lzSW1Gc1p5STZJa1ZUTWpVMklpd2lhMmxrSWpvaVkyNUVhVVZ0TXpaWFkzUkZaMHB3Y0RWQ1gyc3piWGMzWkdkb2F6YzVUWE54WDJ4M1ZrOTFlR2h1VFNKOS5leUpoZFhSb2IzSnBkSGxmYUdsdWRITWlPbHNpYUhSMGNITTZMeTlrWlcxdkxtWmxaR1Z5WVhScGIyNHVaWFZrYVM1M1lXeHNaWFF1WkdWMlpXeHZjR1Z5Y3k1cGRHRnNhV0V1YVhRaVhTd2lhWE56SWpvaWFIUjBjSE02THk5cGJ5MWtMWGRoYkd4bGRDMXBkQzVoZW5WeVpYZGxZbk5wZEdWekxtNWxkQ0lzSW1wM2EzTWlPbnNpYTJWNWN5STZXM3NpYTNSNUlqb2lVbE5CSWl3aVpTSTZJa0ZSUVVJaUxDSnJhV1FpT2lJM1RHMUNlVWRVT0hvelNsQm5VbVo2TmxCM2RteGpkRmRmZURkVlJVTjRRM0ZvZDBwZlltcHVNMFYzSWl3aVlXeG5Jam9pVWxNeU5UWWlMQ0p1SWpvaWNXWkRTVFJPWVV4d1dIcFJOVU5FWDBJdGNFbFFPR0ZuTWpCTWJqbE1WRkEzZVZWWVlUbDZWMlpDYmxsS1gyRlpaVWd4U21VMWFYQlNkRzAxY1VWVVdGTTNiRU5TZUdKcGMydGxTelJrU25WbVkzVXRVMjlSWnpsb1pHYzBhMXBrY1hkblNuUlpVWEZ3T1dKeFkxWnNPWHBWYTBKTGJ6RnViWHBMVG5OZk5qaHhZakJXZUhoSGVHOU1SelZ2YUd0SVNVb3paVzVRY25KQ01reGlkRk5VVldwS01ERTVXaTFRVm10Q2VrSmpjWFJPT1VobU1qQjNPVE5ZZEZsUFdEQlZUMG8yTkc5d1VVMU5UR1ZSWW1Kb1dIRkhMV1UyWTNGeldFUkpRa00xVGsxNFVsRkNVbUV3U2podlMxVnBSVWhUUjFJeFpWbDJVSGhHU2trdFptOXJhMWQ1YjI1R1l6ZHRYM1ppTlRoTFFWUlVUakJtU1hwNFVEY3lRMTgwZWpjMVZHaExaVVp3YTBOWE9EVmFWVU5CTmxKRFJVZFFSRFpKVlVWeVUxUmxZbXB4WkhWSVRIcHVNRkozWVhOcmJ6UlZWMjQ1YjBKUkluMHNleUpyZEhraU9pSkZReUlzSW1OeWRpSTZJbEF0TWpVMklpd2lhMmxrSWpvaVkyNUVhVVZ0TXpaWFkzUkZaMHB3Y0RWQ1gyc3piWGMzWkdkb2F6YzVUWE54WDJ4M1ZrOTFlR2h1VFNJc0luZ2lPaUpIV1dvMWNuZzFPWFJXVVZkdFpqZE5XWE5rUkV0R09IQXRjRU5yYms1elQzZFNNVnBOYVhwMlYyZzRJaXdpZVNJNkltRklRM0ZwV1RKRVdXWjJlRE5hTVU5aGRIaG9XbnBQV1VVM1pGQnhiVkkxYVdaT0xVNDVOMUZmTnpBaWZWMTlMQ0p0WlhSaFpHRjBZU0k2ZXlKbVpXUmxjbUYwYVc5dVgyVnVkR2wwZVNJNmV5Sm9iMjFsY0dGblpWOTFjbWtpT2lKb2RIUndjem92TDJsdkxtbDBZV3hwWVM1cGRDSXNJbXh2WjI5ZmRYSnBJam9pYUhSMGNITTZMeTlwYnk1cGRHRnNhV0V1YVhRdllYTnpaWFJ6TDJsdFp5OXBieTFwZEMxc2IyZHZMV0pzZFdVdWMzWm5JaXdpYjNKbllXNXBlbUYwYVc5dVgyNWhiV1VpT2lKUVlXZHZVR0VnVXk1d0xrRXVJaXdpY0c5c2FXTjVYM1Z5YVNJNkltaDBkSEJ6T2k4dmFXOHVhWFJoYkdsaExtbDBMM0J5YVhaaFkza3RjRzlzYVdONUlpd2lkRzl6WDNWeWFTSTZJbWgwZEhCek9pOHZhVzh1YVhSaGJHbGhMbWwwTDNCeWFYWmhZM2t0Y0c5c2FXTjVJbjBzSW5kaGJHeGxkRjl3Y205MmFXUmxjaUk2ZXlKaFlXeGZkbUZzZFdWelgzTjFjSEJ2Y25SbFpDSTZXeUpvZEhSd2N6b3ZMMmx2TFdRdGQyRnNiR1YwTFdsMExtRjZkWEpsZDJWaWMybDBaWE11Ym1WMEwweHZRUzlpWVhOcFl5SXNJbWgwZEhCek9pOHZhVzh0WkMxM1lXeHNaWFF0YVhRdVlYcDFjbVYzWldKemFYUmxjeTV1WlhRdlRHOUJMMjFsWkdsMWJTSXNJbWgwZEhCek9pOHZhVzh0WkMxM1lXeHNaWFF0YVhRdVlYcDFjbVYzWldKemFYUmxjeTV1WlhRdlRHOUJMMmhwWjJoMElsMHNJbWR5WVc1MFgzUjVjR1Z6WDNOMWNIQnZjblJsWkNJNld5SjFjbTQ2YVdWMFpqcHdZWEpoYlhNNmIyRjFkR2c2WjNKaGJuUXRkSGx3WlRwcWQzUXRZbVZoY21WeUlsMHNJbXAzYTNNaU9uc2lhMlY1Y3lJNlczc2lhM1I1SWpvaVVsTkJJaXdpWlNJNklrRlJRVUlpTENKcmFXUWlPaUkzVEcxQ2VVZFVPSG96U2xCblVtWjZObEIzZG14amRGZGZlRGRWUlVONFEzRm9kMHBmWW1wdU0wVjNJaXdpWVd4bklqb2lVbE15TlRZaUxDSnVJam9pY1daRFNUUk9ZVXh3V0hwUk5VTkVYMEl0Y0VsUU9HRm5NakJNYmpsTVZGQTNlVlZZWVRsNlYyWkNibGxLWDJGWlpVZ3hTbVUxYVhCU2RHMDFjVVZVV0ZNM2JFTlNlR0pwYzJ0bFN6UmtTblZtWTNVdFUyOVJaemxvWkdjMGExcGtjWGRuU25SWlVYRndPV0p4WTFac09YcFZhMEpMYnpGdWJYcExUbk5mTmpoeFlqQldlSGhIZUc5TVJ6VnZhR3RJU1VvelpXNVFjbkpDTWt4aWRGTlVWV3BLTURFNVdpMVFWbXRDZWtKamNYUk9PVWhtTWpCM09UTllkRmxQV0RCVlQwbzJORzl3VVUxTlRHVlJZbUpvV0hGSExXVTJZM0Z6V0VSSlFrTTFUazE0VWxGQ1VtRXdTamh2UzFWcFJVaFRSMUl4WlZsMlVIaEdTa2t0Wm05cmExZDViMjVHWXpkdFgzWmlOVGhMUVZSVVRqQm1TWHA0VURjeVExODBlamMxVkdoTFpVWndhME5YT0RWYVZVTkJObEpEUlVkUVJEWkpWVVZ5VTFSbFltcHhaSFZJVEhwdU1GSjNZWE5yYnpSVlYyNDViMEpSSW4wc2V5SnJkSGtpT2lKRlF5SXNJbU55ZGlJNklsQXRNalUySWl3aWEybGtJam9pWTI1RWFVVnRNelpYWTNSRlowcHdjRFZDWDJzemJYYzNaR2RvYXpjNVRYTnhYMngzVms5MWVHaHVUU0lzSW5naU9pSkhXV28xY25nMU9YUldVVmR0WmpkTldYTmtSRXRHT0hBdGNFTnJiazV6VDNkU01WcE5hWHAyVjJnNElpd2llU0k2SW1GSVEzRnBXVEpFV1daMmVETmFNVTloZEhob1ducFBXVVUzWkZCeGJWSTFhV1pPTFU0NU4xRmZOekFpZlYxOUxDSjBiMnRsYmw5bGJtUndiMmx1ZENJNkltaDBkSEJ6T2k4dmFXOHRaQzEzWVd4c1pYUXRhWFF1WVhwMWNtVjNaV0p6YVhSbGN5NXVaWFF2ZEc5clpXNGlMQ0owYjJ0bGJsOWxibVJ3YjJsdWRGOWhkWFJvWDIxbGRHaHZaSE5mYzNWd2NHOXlkR1ZrSWpwYkluQnlhWFpoZEdWZmEyVjVYMnAzZENKZExDSjBiMnRsYmw5bGJtUndiMmx1ZEY5aGRYUm9YM05wWjI1cGJtZGZZV3huWDNaaGJIVmxjMTl6ZFhCd2IzSjBaV1FpT2xzaVJWTXlOVFlpTENKRlV6STFOa3NpTENKRlV6TTROQ0lzSWtWVE5URXlJaXdpVWxNeU5UWWlMQ0pTVXpNNE5DSXNJbEpUTlRFeUlpd2lVRk15TlRZaUxDSlFVek00TkNJc0lsQlROVEV5SWwxOWZTd2ljM1ZpSWpvaWFIUjBjSE02THk5cGJ5MWtMWGRoYkd4bGRDMXBkQzVoZW5WeVpYZGxZbk5wZEdWekxtNWxkQ0lzSW1saGRDSTZNVGN4T1RNd016TTRNQ3dpWlhod0lqb3hOekU1TXpnNU56Z3dmUS5jeW9aVUZ5dVN3VS1WOU14Qk5qNnNoSzVSakE4OWNfc09qWklPZHFPalZaLWJhbV9NcF8wNnM2bzBESHJtdEhaZGhqZzl0Y19rVEJ2eXNmY3N3ODloQSIsImV5SjBlWEFpT2lKbGJuUnBkSGt0YzNSaGRHVnRaVzUwSzJwM2RDSXNJbUZzWnlJNklsSlRNalUySWl3aWEybGtJam9pTkdOUFZEVTNlR05tZG1JemVqbHFZV3RWY21wWVJ6TTVURE5qYnpCNk9VSkxYelZzUzB0NFZIbDBVU0o5LmV5SmxlSEFpT2pFM01Ua3pOelV6T0RBc0ltbGhkQ0k2TVRjeE9UTXdNek00TUN3aWFYTnpJam9pYUhSMGNITTZMeTlrWlcxdkxtWmxaR1Z5WVhScGIyNHVaWFZrYVM1M1lXeHNaWFF1WkdWMlpXeHZjR1Z5Y3k1cGRHRnNhV0V1YVhRaUxDSnpkV0lpT2lKb2RIUndjem92TDJsdkxXUXRkMkZzYkdWMExXbDBMbUY2ZFhKbGQyVmljMmwwWlhNdWJtVjBJaXdpYW5kcmN5STZleUpyWlhseklqcGJleUpyZEhraU9pSlNVMEVpTENKbElqb2lRVkZCUWlJc0ltdHBaQ0k2SWpkTWJVSjVSMVE0ZWpOS1VHZFNabm8yVUhkMmJHTjBWMTk0TjFWRlEzaERjV2gzU2w5aWFtNHpSWGNpTENKaGJHY2lPaUpTVXpJMU5pSXNJbTRpT2lKeFprTkpORTVoVEhCWWVsRTFRMFJmUWkxd1NWQTRZV2N5TUV4dU9VeFVVRGQ1VlZoaE9YcFhaa0p1V1VwZllWbGxTREZLWlRWcGNGSjBiVFZ4UlZSWVV6ZHNRMUo0WW1semEyVkxOR1JLZFdaamRTMVRiMUZuT1doa1p6UnJXbVJ4ZDJkS2RGbFJjWEE1WW5GalZtdzVlbFZyUWt0dk1XNXRla3RPYzE4Mk9IRmlNRlo0ZUVkNGIweEhOVzlvYTBoSlNqTmxibEJ5Y2tJeVRHSjBVMVJWYWtvd01UbGFMVkJXYTBKNlFtTnhkRTQ1U0dZeU1IYzVNMWgwV1U5WU1GVlBTalkwYjNCUlRVMU1aVkZpWW1oWWNVY3RaVFpqY1hOWVJFbENRelZPVFhoU1VVSlNZVEJLT0c5TFZXbEZTRk5IVWpGbFdYWlFlRVpLU1MxbWIydHJWM2x2Ymtaak4yMWZkbUkxT0V0QlZGUk9NR1pKZW5oUU56SkRYelI2TnpWVWFFdGxSbkJyUTFjNE5WcFZRMEUyVWtORlIxQkVOa2xWUlhKVFZHVmlhbkZrZFVoTWVtNHdVbmRoYzJ0dk5GVlhiamx2UWxFaWZTeDdJbXQwZVNJNklrVkRJaXdpWTNKMklqb2lVQzB5TlRZaUxDSnJhV1FpT2lKamJrUnBSVzB6TmxkamRFVm5TbkJ3TlVKZmF6TnRkemRrWjJock56bE5jM0ZmYkhkV1QzVjRhRzVOSWl3aWVDSTZJa2RaYWpWeWVEVTVkRlpSVjIxbU4wMVpjMlJFUzBZNGNDMXdRMnR1VG5OUGQxSXhXazFwZW5aWGFEZ2lMQ0o1SWpvaVlVaERjV2xaTWtSWlpuWjRNMW94VDJGMGVHaGFlazlaUlRka1VIRnRValZwWms0dFRqazNVVjgzTUNKOVhYMHNJbTFsZEdGa1lYUmhYM0J2YkdsamVTSTZleUozWVd4c1pYUmZjSEp2ZG1sa1pYSWlPbnNpWTI5dWRHRmpkSE1pT25zaVlXUmtJanBiSW1sdkxYZGhiR3hsZEVCd1lXZHZjR0V1YVhRaVhYMTlmU3dpYzI5MWNtTmxYMlZ1WkhCdmFXNTBJam9pYUhSMGNITTZMeTlrWlcxdkxtWmxaR1Z5WVhScGIyNHVaWFZrYVM1M1lXeHNaWFF1WkdWMlpXeHZjR1Z5Y3k1cGRHRnNhV0V1YVhRdlptVjBZMmdpTENKMGNuVnpkRjl0WVhKcmN5STZXM3NpYVdRaU9pSm9kSFJ3Y3pvdkwyUmxiVzh1Wm1Wa1pYSmhkR2x2Ymk1bGRXUnBMbmRoYkd4bGRDNWtaWFpsYkc5d1pYSnpMbWwwWVd4cFlTNXBkQzlsYm5ScGRIa3ZkMkZzYkdWMFgzQnliM1pwWkdWeUlpd2lkSEoxYzNSZmJXRnlheUk2SW1WNVNqQmxXRUZwVDJsS01HTnVWbnBrUXpGMFdWaEtja3N5Y0ROa1EwbHpTVzFHYzFwNVNUWkpiRXBVVFdwVk1rbHBkMmxoTW14clNXcHZhVTVIVGxCV1JGVXpaVWRPYldSdFNYcGxhbXh4V1ZkMFZtTnRjRmxTZWswMVZFUk9hbUo2UWpaUFZVcE1XSHBXYzFNd2REUldTR3d3VlZOS09TNWxlVXB3WXpOTmFVOXBTbTlrU0ZKM1kzcHZka3d5VW14aVZ6aDFXbTFXYTFwWVNtaGtSMngyWW1rMWJHUlhVbkJNYm1Sb1lrZDRiR1JETld0YVdGcHNZa2M1ZDFwWVNucE1iV3d3V1ZkNGNGbFROWEJrUTBselNXNU9NVmxwU1RaSmJXZ3daRWhDZWs5cE9IWmhWemgwV2tNeE0xbFhlSE5hV0ZGMFlWaFJkVmxZY0RGamJWWXpXbGRLZW1GWVVteGplVFYxV2xoUmFVeERTbkJaV0ZGcFQycEZNMDFVYTNwTlJFMTZUMFJCYzBsdGJHdEphbTlwWVVoU01HTklUVFpNZVRscldsY3hka3h0V214YVIxWjVXVmhTY0dJeU5IVmFXRlpyWVZNMU0xbFhlSE5hV0ZGMVdrZFdNbHBYZUhaalIxWjVZM2sxY0dSSFJuTmhWMFYxWVZoUmRscFhOVEJoV0ZJMVRETmthR0pIZUd4a1JqbDNZMjA1TW1GWFVteGphVW81TGsxNWNYQXRlbGRLVTI5d2REQklZVXBTUjJ4a1kwaDZTbVJCVGtzM1dqZEtRVkprVTB4cFkzVjZjbWh0WkdaeVNXbENOV1pDUlV0NmFWVlpSbGxYUlZKeFMxbDZVMVJ0VGtaNU1sbzFjMlZWU0dNeE1FZ3daSFUzWjBoR1NHWjZNRzR3WDBSdFpWbDRka2sxWkVrMlMwWldVWGhxVkVrME1GWkJjMjFOWDBWV2NWY3RZWE5FTVZCc1NFRnliRTF2ZWt0TGJYWlNlamwwU2xwemVWWlJiekJHWmxkd01FMVVNMWRNWkRsa1IwMUNTM0ZhYkRSd2JWWmhhbUpNTmxZeFJIVjFUM014Y1cweVQzaDVRMnRwVjNCSmVWOHliVzFGWDA1QmFYWnNSa295UWxGa05HMXlhMHhMUW5OelEyOWplV1oyTlU1dFduWTNZMHhrWVROMldDMDNOUzFLY2pkWVFtSjZTRkJaTWtvMVVIVTBUSEl5TlcxMlduZFVSakl0V0ZOa04yWlRZVXhCTTBkdlYxWmhaR2RPUVROVk0yRnpRMWRhWWw5cGVUVjJiMWQzYlY5WmIxUjJRemRtVTNSb0xXSldObkpNZHlKOVhYMC5xMnc4R0RwclRoYlFPOUxJNEZ3YjdyeUxVRGhPMG9vQmVWbnhxci1uVnhrU0xObEJOY2pzMFhobmdoX0tEZlF3UFJWNVhBUGJuSi1nSTNhS0VrOU9JZXJ3NExpR2ljRHhVMk9tdG5kejg0X3loV0ZOVzlhb1hFTXlIajFZaF83SHFJNFN2SWUweUNvZXo3RmdwSlc2RVlVTEdodDhuSjlnTGR6Y2M4RXpRU2VpRmZUTllnb3AzN3JEdWV6enVDeERybno5TVQyU1lyRDdJZHhWZm9rZWFQSVRwUTBtN0NVR1ZqTlVGQzRmRHdqZjdpaGFYM2JkZHh2UnZITENUX0JOazJVN2JHcEw0VVJSVnlGWkxPbDVvdUR4NTk3endFc1lmNldpbXc5eUlsbnFDVUhzaEZVMmVVUDJUTGdmeEVKenFhT3AzaUFsbVRZcUJodDVzWURWc3ciXSwidHlwIjoib2F1dGgtY2xpZW50LWF0dGVzdGF0aW9uK2p3dCIsImFsZyI6IkVTMjU2Iiwia2lkIjoiY25EaUVtMzZXY3RFZ0pwcDVCX2szbXc3ZGdoazc5TXNxX2x3Vk91eGhuTSJ9.eyJpc3MiOiJodHRwczovL2lvLWQtd2FsbGV0LWl0LmF6dXJld2Vic2l0ZXMubmV0Iiwic3ViIjoiNG9oUGdVWFFJQS1MdmxxNFh4ZkZkSTdWRzVkU20xWW83NHo0UWtZeU1DbyIsImFhbCI6Imh0dHBzOi8vaW8tZC13YWxsZXQtaXQuYXp1cmV3ZWJzaXRlcy5uZXQvTG9BL2Jhc2ljIiwiY25mIjp7Imp3ayI6eyJjcnYiOiJQLTI1NiIsImtpZCI6InM5b1VKUExuMG4ySm1BWHp1bm9EZEVlUGpTNm9lbXRPM1YtR3AtcEZURFEiLCJrdHkiOiJFQyIsIngiOiJkb0k0YXJsN05NTC1QWXR1YlVVX3had1RWcWZBUFplRGMtYTFKTHRIdmR3IiwieSI6IlBBdWNURDJqMVNkOXU4N2Vhb2JGbE1SYW9fT1JacEJhQmFrYmVLYTVSNzgifX0sIndhbGxldF9saW5rIjoiaHR0cHM6Ly93YWxsZXQuaW8ucGFnb3BhLml0Iiwid2FsbGV0X25hbWUiOiJJVCBXYWxsZXQiLCJpYXQiOjE3MzIwMDQ1NzcsImV4cCI6MTczMjAwODE3N30.BJ1NC5omXoSjhwBtMkwopR0uQr3EhZFWoGyIR-tdfA1NpVD6NIJUkW7_-eopmPyYoXPlXsqcGvnHbNDN8eAnxw";

const wiaCryptoContext: CryptoContext = {
  getPublicKey: async () => ({
    crv: "P-256",
    kid: "s9oUJPLn0n2JmAXzunoDdEePjS6oemtO3V-Gp-pFTDQ",
    kty: "EC",
    x: "doI4arl7NML-PYtubUU_xZwTVqfAPZeDc-a1JLtHvdw",
    y: "PAucTD2j1Sd9u87eaobFlMRao_ORZpBaBakbeKa5R78",
  }),
  getSignature: async () => "",
};

describe("getCredentialTrustmarkJwt", () => {
  beforeEach(async () => {
    // Generate a fresh key before each test
    await generate("WIA_KEYTAG");
  });

  afterEach(async () => {
    jest.resetAllMocks();
    jest.clearAllMocks();
    jest.useRealTimers(); // Reset timers after each test
    await deleteKey("WIA_KEYTAG");
  });

  it("should generate a JWT with the correct payload", async () => {
    // Mock Date
    jest.useFakeTimers();
    jest.setSystemTime(new Date(1732004577000));

    const credentialType = "MDL";

    const { jwt, expirationTime } = await getCredentialTrustmark({
      walletInstanceAttestation,
      wiaCryptoContext,
      credentialType,
      docNumber: "1234567890",
      expirationTime: "2m",
    });

    const decoded = decode(jwt);
    expect(decoded.payload.iss).toBe(walletInstanceAttestation);
    expect(decoded.payload.sub).toContain("*");
    expect(decoded.payload.subtyp).toBe(credentialType);
    expect(expirationTime).toBe(1732004697);
  });

  it("should allow to configure expiration time", async () => {
    // Mock Date
    jest.useFakeTimers();
    jest.setSystemTime(new Date(1732004577000));

    const { expirationTime } = await getCredentialTrustmark({
      walletInstanceAttestation,
      wiaCryptoContext,
      credentialType: "MDL",
      docNumber: "1234567890",
      expirationTime: "10s",
    });
    expect(expirationTime).toBe(1732004587);
  });

  it("should allow to specify an exact expiration time", async () => {
    // Mock Date
    jest.useFakeTimers();
    jest.setSystemTime(new Date(1732004577000));

    const { expirationTime } = await getCredentialTrustmark({
      walletInstanceAttestation,
      wiaCryptoContext,
      credentialType: "MDL",
      docNumber: "1234567890",
      expirationTime: 1732004577,
    });
    expect(expirationTime).toBe(1732004577);
  });

  it("should throw error if wia is expired", async () => {
    // Mock Date
    jest.useFakeTimers();
    jest.setSystemTime(new Date(1832004577000));

    await expect(() =>
      getCredentialTrustmark({
        walletInstanceAttestation,
        wiaCryptoContext,
        credentialType: "MDL",
        docNumber: "1234567890",
        expirationTime: "2m",
      })
    ).rejects.toThrow();
  });

  it("should throw error if thumbprints do not match", async () => {
    const ephemeralKeytag = `ephemeral-${Math.random()}`;
    await generate(ephemeralKeytag);

    await expect(() =>
      getCredentialTrustmark({
        walletInstanceAttestation: "walletInstanceAttestation",
        wiaCryptoContext,
        credentialType: "MDL",
        docNumber: "1234567890",
      })
    ).rejects.toThrow();
  });
});
