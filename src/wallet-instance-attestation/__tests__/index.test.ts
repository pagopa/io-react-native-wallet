import { decode } from "..";

// Wallet Instance Attestation
const token =
  "eyJ0cnVzdF9jaGFpbiI6WyJleUowZVhBaU9pSmxiblJwZEhrdGMzUmhkR1Z0Wlc1MEsycDNkQ0lzSW1Gc1p5STZJa1ZUTWpVMklpd2lhMmxrSWpvaVkyNUVhVVZ0TXpaWFkzUkZaMHB3Y0RWQ1gyc3piWGMzWkdkb2F6YzVUWE54WDJ4M1ZrOTFlR2h1VFNKOS5leUpoZFhSb2IzSnBkSGxmYUdsdWRITWlPbHNpYUhSMGNITTZMeTlrWlcxdkxtWmxaR1Z5WVhScGIyNHVaWFZrYVM1M1lXeHNaWFF1WkdWMlpXeHZjR1Z5Y3k1cGRHRnNhV0V1YVhRaVhTd2lhWE56SWpvaWFIUjBjSE02THk5cGJ5MWtMWGRoYkd4bGRDMXBkQzVoZW5WeVpYZGxZbk5wZEdWekxtNWxkQ0lzSW1wM2EzTWlPbnNpYTJWNWN5STZXM3NpYTNSNUlqb2lVbE5CSWl3aVpTSTZJa0ZSUVVJaUxDSnJhV1FpT2lJM1RHMUNlVWRVT0hvelNsQm5VbVo2TmxCM2RteGpkRmRmZURkVlJVTjRRM0ZvZDBwZlltcHVNMFYzSWl3aVlXeG5Jam9pVWxNeU5UWWlMQ0p1SWpvaWNXWkRTVFJPWVV4d1dIcFJOVU5FWDBJdGNFbFFPR0ZuTWpCTWJqbE1WRkEzZVZWWVlUbDZWMlpDYmxsS1gyRlpaVWd4U21VMWFYQlNkRzAxY1VWVVdGTTNiRU5TZUdKcGMydGxTelJrU25WbVkzVXRVMjlSWnpsb1pHYzBhMXBrY1hkblNuUlpVWEZ3T1dKeFkxWnNPWHBWYTBKTGJ6RnViWHBMVG5OZk5qaHhZakJXZUhoSGVHOU1SelZ2YUd0SVNVb3paVzVRY25KQ01reGlkRk5VVldwS01ERTVXaTFRVm10Q2VrSmpjWFJPT1VobU1qQjNPVE5ZZEZsUFdEQlZUMG8yTkc5d1VVMU5UR1ZSWW1Kb1dIRkhMV1UyWTNGeldFUkpRa00xVGsxNFVsRkNVbUV3U2podlMxVnBSVWhUUjFJeFpWbDJVSGhHU2trdFptOXJhMWQ1YjI1R1l6ZHRYM1ppTlRoTFFWUlVUakJtU1hwNFVEY3lRMTgwZWpjMVZHaExaVVp3YTBOWE9EVmFWVU5CTmxKRFJVZFFSRFpKVlVWeVUxUmxZbXB4WkhWSVRIcHVNRkozWVhOcmJ6UlZWMjQ1YjBKUkluMHNleUpyZEhraU9pSkZReUlzSW1OeWRpSTZJbEF0TWpVMklpd2lhMmxrSWpvaVkyNUVhVVZ0TXpaWFkzUkZaMHB3Y0RWQ1gyc3piWGMzWkdkb2F6YzVUWE54WDJ4M1ZrOTFlR2h1VFNJc0luZ2lPaUpIV1dvMWNuZzFPWFJXVVZkdFpqZE5XWE5rUkV0R09IQXRjRU5yYms1elQzZFNNVnBOYVhwMlYyZzRJaXdpZVNJNkltRklRM0ZwV1RKRVdXWjJlRE5hTVU5aGRIaG9XbnBQV1VVM1pGQnhiVkkxYVdaT0xVNDVOMUZmTnpBaWZWMTlMQ0p0WlhSaFpHRjBZU0k2ZXlKbVpXUmxjbUYwYVc5dVgyVnVkR2wwZVNJNmV5Sm9iMjFsY0dGblpWOTFjbWtpT2lKb2RIUndjem92TDJsdkxtbDBZV3hwWVM1cGRDSXNJbXh2WjI5ZmRYSnBJam9pYUhSMGNITTZMeTlwYnk1cGRHRnNhV0V1YVhRdllYTnpaWFJ6TDJsdFp5OXBieTFwZEMxc2IyZHZMV0pzZFdVdWMzWm5JaXdpYjNKbllXNXBlbUYwYVc5dVgyNWhiV1VpT2lKUVlXZHZVR0VnVXk1d0xrRXVJaXdpY0c5c2FXTjVYM1Z5YVNJNkltaDBkSEJ6T2k4dmFXOHVhWFJoYkdsaExtbDBMM0J5YVhaaFkza3RjRzlzYVdONUlpd2lkRzl6WDNWeWFTSTZJbWgwZEhCek9pOHZhVzh1YVhSaGJHbGhMbWwwTDNCeWFYWmhZM2t0Y0c5c2FXTjVJbjBzSW5kaGJHeGxkRjl3Y205MmFXUmxjaUk2ZXlKaFlXeGZkbUZzZFdWelgzTjFjSEJ2Y25SbFpDSTZXeUpvZEhSd2N6b3ZMMmx2TFdRdGQyRnNiR1YwTFdsMExtRjZkWEpsZDJWaWMybDBaWE11Ym1WMEwweHZRUzlpWVhOcFl5SXNJbWgwZEhCek9pOHZhVzh0WkMxM1lXeHNaWFF0YVhRdVlYcDFjbVYzWldKemFYUmxjeTV1WlhRdlRHOUJMMjFsWkdsMWJTSXNJbWgwZEhCek9pOHZhVzh0WkMxM1lXeHNaWFF0YVhRdVlYcDFjbVYzWldKemFYUmxjeTV1WlhRdlRHOUJMMmhwWjJoMElsMHNJbWR5WVc1MFgzUjVjR1Z6WDNOMWNIQnZjblJsWkNJNld5SjFjbTQ2YVdWMFpqcHdZWEpoYlhNNmIyRjFkR2c2WjNKaGJuUXRkSGx3WlRwcWQzUXRZbVZoY21WeUlsMHNJbXAzYTNNaU9uc2lhMlY1Y3lJNlczc2lhM1I1SWpvaVVsTkJJaXdpWlNJNklrRlJRVUlpTENKcmFXUWlPaUkzVEcxQ2VVZFVPSG96U2xCblVtWjZObEIzZG14amRGZGZlRGRWUlVONFEzRm9kMHBmWW1wdU0wVjNJaXdpWVd4bklqb2lVbE15TlRZaUxDSnVJam9pY1daRFNUUk9ZVXh3V0hwUk5VTkVYMEl0Y0VsUU9HRm5NakJNYmpsTVZGQTNlVlZZWVRsNlYyWkNibGxLWDJGWlpVZ3hTbVUxYVhCU2RHMDFjVVZVV0ZNM2JFTlNlR0pwYzJ0bFN6UmtTblZtWTNVdFUyOVJaemxvWkdjMGExcGtjWGRuU25SWlVYRndPV0p4WTFac09YcFZhMEpMYnpGdWJYcExUbk5mTmpoeFlqQldlSGhIZUc5TVJ6VnZhR3RJU1VvelpXNVFjbkpDTWt4aWRGTlVWV3BLTURFNVdpMVFWbXRDZWtKamNYUk9PVWhtTWpCM09UTllkRmxQV0RCVlQwbzJORzl3VVUxTlRHVlJZbUpvV0hGSExXVTJZM0Z6V0VSSlFrTTFUazE0VWxGQ1VtRXdTamh2UzFWcFJVaFRSMUl4WlZsMlVIaEdTa2t0Wm05cmExZDViMjVHWXpkdFgzWmlOVGhMUVZSVVRqQm1TWHA0VURjeVExODBlamMxVkdoTFpVWndhME5YT0RWYVZVTkJObEpEUlVkUVJEWkpWVVZ5VTFSbFltcHhaSFZJVEhwdU1GSjNZWE5yYnpSVlYyNDViMEpSSW4wc2V5SnJkSGtpT2lKRlF5SXNJbU55ZGlJNklsQXRNalUySWl3aWEybGtJam9pWTI1RWFVVnRNelpYWTNSRlowcHdjRFZDWDJzemJYYzNaR2RvYXpjNVRYTnhYMngzVms5MWVHaHVUU0lzSW5naU9pSkhXV28xY25nMU9YUldVVmR0WmpkTldYTmtSRXRHT0hBdGNFTnJiazV6VDNkU01WcE5hWHAyVjJnNElpd2llU0k2SW1GSVEzRnBXVEpFV1daMmVETmFNVTloZEhob1ducFBXVVUzWkZCeGJWSTFhV1pPTFU0NU4xRmZOekFpZlYxOUxDSjBiMnRsYmw5bGJtUndiMmx1ZENJNkltaDBkSEJ6T2k4dmFXOHRaQzEzWVd4c1pYUXRhWFF1WVhwMWNtVjNaV0p6YVhSbGN5NXVaWFF2ZEc5clpXNGlMQ0owYjJ0bGJsOWxibVJ3YjJsdWRGOWhkWFJvWDIxbGRHaHZaSE5mYzNWd2NHOXlkR1ZrSWpwYkluQnlhWFpoZEdWZmEyVjVYMnAzZENKZExDSjBiMnRsYmw5bGJtUndiMmx1ZEY5aGRYUm9YM05wWjI1cGJtZGZZV3huWDNaaGJIVmxjMTl6ZFhCd2IzSjBaV1FpT2xzaVJWTXlOVFlpTENKRlV6STFOa3NpTENKRlV6TTROQ0lzSWtWVE5URXlJaXdpVWxNeU5UWWlMQ0pTVXpNNE5DSXNJbEpUTlRFeUlpd2lVRk15TlRZaUxDSlFVek00TkNJc0lsQlROVEV5SWwxOWZTd2ljM1ZpSWpvaWFIUjBjSE02THk5cGJ5MWtMWGRoYkd4bGRDMXBkQzVoZW5WeVpYZGxZbk5wZEdWekxtNWxkQ0lzSW1saGRDSTZNVGN4T1RNd016TTRNQ3dpWlhod0lqb3hOekU1TXpnNU56Z3dmUS5jeW9aVUZ5dVN3VS1WOU14Qk5qNnNoSzVSakE4OWNfc09qWklPZHFPalZaLWJhbV9NcF8wNnM2bzBESHJtdEhaZGhqZzl0Y19rVEJ2eXNmY3N3ODloQSIsImV5SjBlWEFpT2lKbGJuUnBkSGt0YzNSaGRHVnRaVzUwSzJwM2RDSXNJbUZzWnlJNklsSlRNalUySWl3aWEybGtJam9pTkdOUFZEVTNlR05tZG1JemVqbHFZV3RWY21wWVJ6TTVURE5qYnpCNk9VSkxYelZzUzB0NFZIbDBVU0o5LmV5SmxlSEFpT2pFM01Ua3pOelV6T0RBc0ltbGhkQ0k2TVRjeE9UTXdNek00TUN3aWFYTnpJam9pYUhSMGNITTZMeTlrWlcxdkxtWmxaR1Z5WVhScGIyNHVaWFZrYVM1M1lXeHNaWFF1WkdWMlpXeHZjR1Z5Y3k1cGRHRnNhV0V1YVhRaUxDSnpkV0lpT2lKb2RIUndjem92TDJsdkxXUXRkMkZzYkdWMExXbDBMbUY2ZFhKbGQyVmljMmwwWlhNdWJtVjBJaXdpYW5kcmN5STZleUpyWlhseklqcGJleUpyZEhraU9pSlNVMEVpTENKbElqb2lRVkZCUWlJc0ltdHBaQ0k2SWpkTWJVSjVSMVE0ZWpOS1VHZFNabm8yVUhkMmJHTjBWMTk0TjFWRlEzaERjV2gzU2w5aWFtNHpSWGNpTENKaGJHY2lPaUpTVXpJMU5pSXNJbTRpT2lKeFprTkpORTVoVEhCWWVsRTFRMFJmUWkxd1NWQTRZV2N5TUV4dU9VeFVVRGQ1VlZoaE9YcFhaa0p1V1VwZllWbGxTREZLWlRWcGNGSjBiVFZ4UlZSWVV6ZHNRMUo0WW1semEyVkxOR1JLZFdaamRTMVRiMUZuT1doa1p6UnJXbVJ4ZDJkS2RGbFJjWEE1WW5GalZtdzVlbFZyUWt0dk1XNXRla3RPYzE4Mk9IRmlNRlo0ZUVkNGIweEhOVzlvYTBoSlNqTmxibEJ5Y2tJeVRHSjBVMVJWYWtvd01UbGFMVkJXYTBKNlFtTnhkRTQ1U0dZeU1IYzVNMWgwV1U5WU1GVlBTalkwYjNCUlRVMU1aVkZpWW1oWWNVY3RaVFpqY1hOWVJFbENRelZPVFhoU1VVSlNZVEJLT0c5TFZXbEZTRk5IVWpGbFdYWlFlRVpLU1MxbWIydHJWM2x2Ymtaak4yMWZkbUkxT0V0QlZGUk9NR1pKZW5oUU56SkRYelI2TnpWVWFFdGxSbkJyUTFjNE5WcFZRMEUyVWtORlIxQkVOa2xWUlhKVFZHVmlhbkZrZFVoTWVtNHdVbmRoYzJ0dk5GVlhiamx2UWxFaWZTeDdJbXQwZVNJNklrVkRJaXdpWTNKMklqb2lVQzB5TlRZaUxDSnJhV1FpT2lKamJrUnBSVzB6TmxkamRFVm5TbkJ3TlVKZmF6TnRkemRrWjJock56bE5jM0ZmYkhkV1QzVjRhRzVOSWl3aWVDSTZJa2RaYWpWeWVEVTVkRlpSVjIxbU4wMVpjMlJFUzBZNGNDMXdRMnR1VG5OUGQxSXhXazFwZW5aWGFEZ2lMQ0o1SWpvaVlVaERjV2xaTWtSWlpuWjRNMW94VDJGMGVHaGFlazlaUlRka1VIRnRValZwWms0dFRqazNVVjgzTUNKOVhYMHNJbTFsZEdGa1lYUmhYM0J2YkdsamVTSTZleUozWVd4c1pYUmZjSEp2ZG1sa1pYSWlPbnNpWTI5dWRHRmpkSE1pT25zaVlXUmtJanBiSW1sdkxYZGhiR3hsZEVCd1lXZHZjR0V1YVhRaVhYMTlmU3dpYzI5MWNtTmxYMlZ1WkhCdmFXNTBJam9pYUhSMGNITTZMeTlrWlcxdkxtWmxaR1Z5WVhScGIyNHVaWFZrYVM1M1lXeHNaWFF1WkdWMlpXeHZjR1Z5Y3k1cGRHRnNhV0V1YVhRdlptVjBZMmdpTENKMGNuVnpkRjl0WVhKcmN5STZXM3NpYVdRaU9pSm9kSFJ3Y3pvdkwyUmxiVzh1Wm1Wa1pYSmhkR2x2Ymk1bGRXUnBMbmRoYkd4bGRDNWtaWFpsYkc5d1pYSnpMbWwwWVd4cFlTNXBkQzlsYm5ScGRIa3ZkMkZzYkdWMFgzQnliM1pwWkdWeUlpd2lkSEoxYzNSZmJXRnlheUk2SW1WNVNqQmxXRUZwVDJsS01HTnVWbnBrUXpGMFdWaEtja3N5Y0ROa1EwbHpTVzFHYzFwNVNUWkpiRXBVVFdwVk1rbHBkMmxoTW14clNXcHZhVTVIVGxCV1JGVXpaVWRPYldSdFNYcGxhbXh4V1ZkMFZtTnRjRmxTZWswMVZFUk9hbUo2UWpaUFZVcE1XSHBXYzFNd2REUldTR3d3VlZOS09TNWxlVXB3WXpOTmFVOXBTbTlrU0ZKM1kzcHZka3d5VW14aVZ6aDFXbTFXYTFwWVNtaGtSMngyWW1rMWJHUlhVbkJNYm1Sb1lrZDRiR1JETld0YVdGcHNZa2M1ZDFwWVNucE1iV3d3V1ZkNGNGbFROWEJrUTBselNXNU9NVmxwU1RaSmJXZ3daRWhDZWs5cE9IWmhWemgwV2tNeE0xbFhlSE5hV0ZGMFlWaFJkVmxZY0RGamJWWXpXbGRLZW1GWVVteGplVFYxV2xoUmFVeERTbkJaV0ZGcFQycEZNMDFVYTNwTlJFMTZUMFJCYzBsdGJHdEphbTlwWVVoU01HTklUVFpNZVRscldsY3hka3h0V214YVIxWjVXVmhTY0dJeU5IVmFXRlpyWVZNMU0xbFhlSE5hV0ZGMVdrZFdNbHBYZUhaalIxWjVZM2sxY0dSSFJuTmhWMFYxWVZoUmRscFhOVEJoV0ZJMVRETmthR0pIZUd4a1JqbDNZMjA1TW1GWFVteGphVW81TGsxNWNYQXRlbGRLVTI5d2REQklZVXBTUjJ4a1kwaDZTbVJCVGtzM1dqZEtRVkprVTB4cFkzVjZjbWh0WkdaeVNXbENOV1pDUlV0NmFWVlpSbGxYUlZKeFMxbDZVMVJ0VGtaNU1sbzFjMlZWU0dNeE1FZ3daSFUzWjBoR1NHWjZNRzR3WDBSdFpWbDRka2sxWkVrMlMwWldVWGhxVkVrME1GWkJjMjFOWDBWV2NWY3RZWE5FTVZCc1NFRnliRTF2ZWt0TGJYWlNlamwwU2xwemVWWlJiekJHWmxkd01FMVVNMWRNWkRsa1IwMUNTM0ZhYkRSd2JWWmhhbUpNTmxZeFJIVjFUM014Y1cweVQzaDVRMnRwVjNCSmVWOHliVzFGWDA1QmFYWnNSa295UWxGa05HMXlhMHhMUW5OelEyOWplV1oyTlU1dFduWTNZMHhrWVROMldDMDNOUzFLY2pkWVFtSjZTRkJaTWtvMVVIVTBUSEl5TlcxMlduZFVSakl0V0ZOa04yWlRZVXhCTTBkdlYxWmhaR2RPUVROVk0yRnpRMWRhWWw5cGVUVjJiMWQzYlY5WmIxUjJRemRtVTNSb0xXSldObkpNZHlKOVhYMC5xMnc4R0RwclRoYlFPOUxJNEZ3YjdyeUxVRGhPMG9vQmVWbnhxci1uVnhrU0xObEJOY2pzMFhobmdoX0tEZlF3UFJWNVhBUGJuSi1nSTNhS0VrOU9JZXJ3NExpR2ljRHhVMk9tdG5kejg0X3loV0ZOVzlhb1hFTXlIajFZaF83SHFJNFN2SWUweUNvZXo3RmdwSlc2RVlVTEdodDhuSjlnTGR6Y2M4RXpRU2VpRmZUTllnb3AzN3JEdWV6enVDeERybno5TVQyU1lyRDdJZHhWZm9rZWFQSVRwUTBtN0NVR1ZqTlVGQzRmRHdqZjdpaGFYM2JkZHh2UnZITENUX0JOazJVN2JHcEw0VVJSVnlGWkxPbDVvdUR4NTk3endFc1lmNldpbXc5eUlsbnFDVUhzaEZVMmVVUDJUTGdmeEVKenFhT3AzaUFsbVRZcUJodDVzWURWc3ciXSwidHlwIjoid2FsbGV0LWF0dGVzdGF0aW9uK2p3dCIsImFsZyI6IkVTMjU2Iiwia2lkIjoiY25EaUVtMzZXY3RFZ0pwcDVCX2szbXc3ZGdoazc5TXNxX2x3Vk91eGhuTSJ9.eyJhYWwiOiJodHRwczovL2lvLWQtd2FsbGV0LWl0LmF6dXJld2Vic2l0ZXMubmV0L0xvQS9iYXNpYyIsImF1dGhvcml6YXRpb25fZW5kcG9pbnQiOiJldWRpdzoiLCJjbmYiOnsiandrIjp7ImNydiI6IlAtMjU2Iiwia2lkIjoiNG9oUGdVWFFJQS1MdmxxNFh4ZkZkSTdWRzVkU20xWW83NHo0UWtZeU1DbyIsImt0eSI6IkVDIiwieCI6InVDZ0tnRzk5MFg2QkxBTmM4dkpqV1hHcW9DZ3ltTi1JeUU4bkNwRHFibnciLCJ5IjoiVGVIdGNXX1l2aXNFaGxiemVJMGZVRXhXNjNUZlBWc3Q2Q2NmWHA0STdjSSJ9fSwiaG9tZXBhZ2VfdXJpIjoiaHR0cHM6Ly9pby5pdGFsaWEuaXQiLCJpc3MiOiJodHRwczovL2lvLWQtd2FsbGV0LWl0LmF6dXJld2Vic2l0ZXMubmV0IiwicHJlc2VudGF0aW9uX2RlZmluaXRpb25fdXJpX3N1cHBvcnRlZCI6ZmFsc2UsInJlcXVlc3Rfb2JqZWN0X3NpZ25pbmdfYWxnX3ZhbHVlc19zdXBwb3J0ZWQiOlsiRVMyNTYiXSwicmVzcG9uc2VfbW9kZXNfc3VwcG9ydGVkIjpbImZvcm1fcG9zdC5qd3QiXSwicmVzcG9uc2VfdHlwZXNfc3VwcG9ydGVkIjpbInZwX3Rva2VuIl0sInN1YiI6IjRvaFBnVVhRSUEtTHZscTRYeGZGZEk3Vkc1ZFNtMVlvNzR6NFFrWXlNQ28iLCJ2cF9mb3JtYXRzX3N1cHBvcnRlZCI6eyJ2YytzZC1qd3QiOnsic2Qtand0X2FsZ192YWx1ZXMiOlsiRVMyNTYiLCJFUzI1NksiLCJFUzM4NCIsIkVTNTEyIiwiUlMyNTYiLCJSUzM4NCIsIlJTNTEyIiwiUFMyNTYiLCJQUzM4NCIsIlBTNTEyIl19LCJ2cCtzZC1qd3QiOnsic2Qtand0X2FsZ192YWx1ZXMiOlsiRVMyNTYiLCJFUzI1NksiLCJFUzM4NCIsIkVTNTEyIiwiUlMyNTYiLCJSUzM4NCIsIlJTNTEyIiwiUFMyNTYiLCJQUzM4NCIsIlBTNTEyIl19fSwiaWF0IjoxNzE5MzAzMzgxLCJleHAiOjE3MTkzMDY5ODF9.nB_WS0tjibhhpuE4EhR0UWiKiXitZaOfdtI8ykSG0LlfuitIU_Rh9wnAvr4hmCAkBI8y4UFb45jcmN381aAOvw";

describe("decode", () => {
  it("should return Wallet Instance Attestation", async () => {
    const result = decode(token);

    // check shallow shape
    expect(result).toEqual(expect.any(Object));

    // check header in deep
    expect(result.header).toEqual({
      alg: "ES256",
      kid: "cnDiEm36WctEgJpp5B_k3mw7dghk79Msq_lwVOuxhnM",
      trust_chain: [
        "eyJ0eXAiOiJlbnRpdHktc3RhdGVtZW50K2p3dCIsImFsZyI6IkVTMjU2Iiwia2lkIjoiY25EaUVtMzZXY3RFZ0pwcDVCX2szbXc3ZGdoazc5TXNxX2x3Vk91eGhuTSJ9.eyJhdXRob3JpdHlfaGludHMiOlsiaHR0cHM6Ly9kZW1vLmZlZGVyYXRpb24uZXVkaS53YWxsZXQuZGV2ZWxvcGVycy5pdGFsaWEuaXQiXSwiaXNzIjoiaHR0cHM6Ly9pby1kLXdhbGxldC1pdC5henVyZXdlYnNpdGVzLm5ldCIsImp3a3MiOnsia2V5cyI6W3sia3R5IjoiUlNBIiwiZSI6IkFRQUIiLCJraWQiOiI3TG1CeUdUOHozSlBnUmZ6NlB3dmxjdFdfeDdVRUN4Q3Fod0pfYmpuM0V3IiwiYWxnIjoiUlMyNTYiLCJuIjoicWZDSTROYUxwWHpRNUNEX0ItcElQOGFnMjBMbjlMVFA3eVVYYTl6V2ZCbllKX2FZZUgxSmU1aXBSdG01cUVUWFM3bENSeGJpc2tlSzRkSnVmY3UtU29RZzloZGc0a1pkcXdnSnRZUXFwOWJxY1ZsOXpVa0JLbzFubXpLTnNfNjhxYjBWeHhHeG9MRzVvaGtISUozZW5QcnJCMkxidFNUVWpKMDE5Wi1QVmtCekJjcXROOUhmMjB3OTNYdFlPWDBVT0o2NG9wUU1NTGVRYmJoWHFHLWU2Y3FzWERJQkM1Tk14UlFCUmEwSjhvS1VpRUhTR1IxZVl2UHhGSkktZm9ra1d5b25GYzdtX3ZiNThLQVRUTjBmSXp4UDcyQ180ejc1VGhLZUZwa0NXODVaVUNBNlJDRUdQRDZJVUVyU1RlYmpxZHVITHpuMFJ3YXNrbzRVV245b0JRIn0seyJrdHkiOiJFQyIsImNydiI6IlAtMjU2Iiwia2lkIjoiY25EaUVtMzZXY3RFZ0pwcDVCX2szbXc3ZGdoazc5TXNxX2x3Vk91eGhuTSIsIngiOiJHWWo1cng1OXRWUVdtZjdNWXNkREtGOHAtcENrbk5zT3dSMVpNaXp2V2g4IiwieSI6ImFIQ3FpWTJEWWZ2eDNaMU9hdHhoWnpPWUU3ZFBxbVI1aWZOLU45N1FfNzAifV19LCJtZXRhZGF0YSI6eyJmZWRlcmF0aW9uX2VudGl0eSI6eyJob21lcGFnZV91cmkiOiJodHRwczovL2lvLml0YWxpYS5pdCIsImxvZ29fdXJpIjoiaHR0cHM6Ly9pby5pdGFsaWEuaXQvYXNzZXRzL2ltZy9pby1pdC1sb2dvLWJsdWUuc3ZnIiwib3JnYW5pemF0aW9uX25hbWUiOiJQYWdvUGEgUy5wLkEuIiwicG9saWN5X3VyaSI6Imh0dHBzOi8vaW8uaXRhbGlhLml0L3ByaXZhY3ktcG9saWN5IiwidG9zX3VyaSI6Imh0dHBzOi8vaW8uaXRhbGlhLml0L3ByaXZhY3ktcG9saWN5In0sIndhbGxldF9wcm92aWRlciI6eyJhYWxfdmFsdWVzX3N1cHBvcnRlZCI6WyJodHRwczovL2lvLWQtd2FsbGV0LWl0LmF6dXJld2Vic2l0ZXMubmV0L0xvQS9iYXNpYyIsImh0dHBzOi8vaW8tZC13YWxsZXQtaXQuYXp1cmV3ZWJzaXRlcy5uZXQvTG9BL21lZGl1bSIsImh0dHBzOi8vaW8tZC13YWxsZXQtaXQuYXp1cmV3ZWJzaXRlcy5uZXQvTG9BL2hpZ2h0Il0sImdyYW50X3R5cGVzX3N1cHBvcnRlZCI6WyJ1cm46aWV0ZjpwYXJhbXM6b2F1dGg6Z3JhbnQtdHlwZTpqd3QtYmVhcmVyIl0sImp3a3MiOnsia2V5cyI6W3sia3R5IjoiUlNBIiwiZSI6IkFRQUIiLCJraWQiOiI3TG1CeUdUOHozSlBnUmZ6NlB3dmxjdFdfeDdVRUN4Q3Fod0pfYmpuM0V3IiwiYWxnIjoiUlMyNTYiLCJuIjoicWZDSTROYUxwWHpRNUNEX0ItcElQOGFnMjBMbjlMVFA3eVVYYTl6V2ZCbllKX2FZZUgxSmU1aXBSdG01cUVUWFM3bENSeGJpc2tlSzRkSnVmY3UtU29RZzloZGc0a1pkcXdnSnRZUXFwOWJxY1ZsOXpVa0JLbzFubXpLTnNfNjhxYjBWeHhHeG9MRzVvaGtISUozZW5QcnJCMkxidFNUVWpKMDE5Wi1QVmtCekJjcXROOUhmMjB3OTNYdFlPWDBVT0o2NG9wUU1NTGVRYmJoWHFHLWU2Y3FzWERJQkM1Tk14UlFCUmEwSjhvS1VpRUhTR1IxZVl2UHhGSkktZm9ra1d5b25GYzdtX3ZiNThLQVRUTjBmSXp4UDcyQ180ejc1VGhLZUZwa0NXODVaVUNBNlJDRUdQRDZJVUVyU1RlYmpxZHVITHpuMFJ3YXNrbzRVV245b0JRIn0seyJrdHkiOiJFQyIsImNydiI6IlAtMjU2Iiwia2lkIjoiY25EaUVtMzZXY3RFZ0pwcDVCX2szbXc3ZGdoazc5TXNxX2x3Vk91eGhuTSIsIngiOiJHWWo1cng1OXRWUVdtZjdNWXNkREtGOHAtcENrbk5zT3dSMVpNaXp2V2g4IiwieSI6ImFIQ3FpWTJEWWZ2eDNaMU9hdHhoWnpPWUU3ZFBxbVI1aWZOLU45N1FfNzAifV19LCJ0b2tlbl9lbmRwb2ludCI6Imh0dHBzOi8vaW8tZC13YWxsZXQtaXQuYXp1cmV3ZWJzaXRlcy5uZXQvdG9rZW4iLCJ0b2tlbl9lbmRwb2ludF9hdXRoX21ldGhvZHNfc3VwcG9ydGVkIjpbInByaXZhdGVfa2V5X2p3dCJdLCJ0b2tlbl9lbmRwb2ludF9hdXRoX3NpZ25pbmdfYWxnX3ZhbHVlc19zdXBwb3J0ZWQiOlsiRVMyNTYiLCJFUzI1NksiLCJFUzM4NCIsIkVTNTEyIiwiUlMyNTYiLCJSUzM4NCIsIlJTNTEyIiwiUFMyNTYiLCJQUzM4NCIsIlBTNTEyIl19fSwic3ViIjoiaHR0cHM6Ly9pby1kLXdhbGxldC1pdC5henVyZXdlYnNpdGVzLm5ldCIsImlhdCI6MTcxOTMwMzM4MCwiZXhwIjoxNzE5Mzg5NzgwfQ.cyoZUFyuSwU-V9MxBNj6shK5RjA89c_sOjZIOdqOjVZ-bam_Mp_06s6o0DHrmtHZdhjg9tc_kTBvysfcsw89hA",
        "eyJ0eXAiOiJlbnRpdHktc3RhdGVtZW50K2p3dCIsImFsZyI6IlJTMjU2Iiwia2lkIjoiNGNPVDU3eGNmdmIzejlqYWtVcmpYRzM5TDNjbzB6OUJLXzVsS0t4VHl0USJ9.eyJleHAiOjE3MTkzNzUzODAsImlhdCI6MTcxOTMwMzM4MCwiaXNzIjoiaHR0cHM6Ly9kZW1vLmZlZGVyYXRpb24uZXVkaS53YWxsZXQuZGV2ZWxvcGVycy5pdGFsaWEuaXQiLCJzdWIiOiJodHRwczovL2lvLWQtd2FsbGV0LWl0LmF6dXJld2Vic2l0ZXMubmV0IiwiandrcyI6eyJrZXlzIjpbeyJrdHkiOiJSU0EiLCJlIjoiQVFBQiIsImtpZCI6IjdMbUJ5R1Q4ejNKUGdSZno2UHd2bGN0V194N1VFQ3hDcWh3Sl9iam4zRXciLCJhbGciOiJSUzI1NiIsIm4iOiJxZkNJNE5hTHBYelE1Q0RfQi1wSVA4YWcyMExuOUxUUDd5VVhhOXpXZkJuWUpfYVllSDFKZTVpcFJ0bTVxRVRYUzdsQ1J4Ymlza2VLNGRKdWZjdS1Tb1FnOWhkZzRrWmRxd2dKdFlRcXA5YnFjVmw5elVrQktvMW5tektOc182OHFiMFZ4eEd4b0xHNW9oa0hJSjNlblByckIyTGJ0U1RVakowMTlaLVBWa0J6QmNxdE45SGYyMHc5M1h0WU9YMFVPSjY0b3BRTU1MZVFiYmhYcUctZTZjcXNYRElCQzVOTXhSUUJSYTBKOG9LVWlFSFNHUjFlWXZQeEZKSS1mb2trV3lvbkZjN21fdmI1OEtBVFROMGZJenhQNzJDXzR6NzVUaEtlRnBrQ1c4NVpVQ0E2UkNFR1BENklVRXJTVGVianFkdUhMem4wUndhc2tvNFVXbjlvQlEifSx7Imt0eSI6IkVDIiwiY3J2IjoiUC0yNTYiLCJraWQiOiJjbkRpRW0zNldjdEVnSnBwNUJfazNtdzdkZ2hrNzlNc3FfbHdWT3V4aG5NIiwieCI6IkdZajVyeDU5dFZRV21mN01Zc2RES0Y4cC1wQ2tuTnNPd1IxWk1penZXaDgiLCJ5IjoiYUhDcWlZMkRZZnZ4M1oxT2F0eGhaek9ZRTdkUHFtUjVpZk4tTjk3UV83MCJ9XX0sIm1ldGFkYXRhX3BvbGljeSI6eyJ3YWxsZXRfcHJvdmlkZXIiOnsiY29udGFjdHMiOnsiYWRkIjpbImlvLXdhbGxldEBwYWdvcGEuaXQiXX19fSwic291cmNlX2VuZHBvaW50IjoiaHR0cHM6Ly9kZW1vLmZlZGVyYXRpb24uZXVkaS53YWxsZXQuZGV2ZWxvcGVycy5pdGFsaWEuaXQvZmV0Y2giLCJ0cnVzdF9tYXJrcyI6W3siaWQiOiJodHRwczovL2RlbW8uZmVkZXJhdGlvbi5ldWRpLndhbGxldC5kZXZlbG9wZXJzLml0YWxpYS5pdC9lbnRpdHkvd2FsbGV0X3Byb3ZpZGVyIiwidHJ1c3RfbWFyayI6ImV5SjBlWEFpT2lKMGNuVnpkQzF0WVhKcksycDNkQ0lzSW1Gc1p5STZJbEpUTWpVMklpd2lhMmxrSWpvaU5HTlBWRFUzZUdObWRtSXplamxxWVd0VmNtcFlSek01VEROamJ6QjZPVUpMWHpWc1MwdDRWSGwwVVNKOS5leUpwYzNNaU9pSm9kSFJ3Y3pvdkwyUmxiVzh1Wm1Wa1pYSmhkR2x2Ymk1bGRXUnBMbmRoYkd4bGRDNWtaWFpsYkc5d1pYSnpMbWwwWVd4cFlTNXBkQ0lzSW5OMVlpSTZJbWgwZEhCek9pOHZhVzh0WkMxM1lXeHNaWFF0YVhRdVlYcDFjbVYzWldKemFYUmxjeTV1WlhRaUxDSnBZWFFpT2pFM01Ua3pNRE16T0RBc0ltbGtJam9pYUhSMGNITTZMeTlrWlcxdkxtWmxaR1Z5WVhScGIyNHVaWFZrYVM1M1lXeHNaWFF1WkdWMlpXeHZjR1Z5Y3k1cGRHRnNhV0V1YVhRdlpXNTBhWFI1TDNkaGJHeGxkRjl3Y205MmFXUmxjaUo5Lk15cXAteldKU29wdDBIYUpSR2xkY0h6SmRBTks3WjdKQVJkU0xpY3V6cmhtZGZySWlCNWZCRUt6aVVZRllXRVJxS1l6U1RtTkZ5Mlo1c2VVSGMxMEgwZHU3Z0hGSGZ6MG4wX0RtZVl4dkk1ZEk2S0ZWUXhqVEk0MFZBc21NX0VWcVctYXNEMVBsSEFybE1vektLbXZSejl0SlpzeVZRbzBGZldwME1UM1dMZDlkR01CS3FabDRwbVZhamJMNlYxRHV1T3MxcW0yT3h5Q2tpV3BJeV8ybW1FX05BaXZsRkoyQlFkNG1ya0xLQnNzQ29jeWZ2NU5tWnY3Y0xkYTN2WC03NS1KcjdYQmJ6SFBZMko1UHU0THIyNW12WndURjItWFNkN2ZTYUxBM0dvV1ZhZGdOQTNVM2FzQ1daYl9peTV2b1d3bV9Zb1R2QzdmU3RoLWJWNnJMdyJ9XX0.q2w8GDprThbQO9LI4Fwb7ryLUDhO0ooBeVnxqr-nVxkSLNlBNcjs0Xhngh_KDfQwPRV5XAPbnJ-gI3aKEk9OIerw4LiGicDxU2Omtndz84_yhWFNW9aoXEMyHj1Yh_7HqI4SvIe0yCoez7FgpJW6EYULGht8nJ9gLdzcc8EzQSeiFfTNYgop37rDuezzuCxDrnz9MT2SYrD7IdxVfokeaPITpQ0m7CUGVjNUFC4fDwjf7ihaX3bddxvRvHLCT_BNk2U7bGpL4URRVyFZLOl5ouDx597zwEsYf6Wimw9yIlnqCUHshFU2eUP2TLgfxEJzqaOp3iAlmTYqBht5sYDVsw",
      ],
      typ: "wallet-attestation+jwt",
    });

    // check payload in deep
    expect(result.payload).toEqual({
      iss: "https://io-d-wallet-it.azurewebsites.net",
      sub: "4ohPgUXQIA-Lvlq4XxfFdI7VG5dSm1Yo74z4QkYyMCo",
      aal: "https://io-d-wallet-it.azurewebsites.net/LoA/basic",
      cnf: {
        jwk: {
          crv: "P-256",
          kty: "EC",
          x: "uCgKgG990X6BLANc8vJjWXGqoCgymN-IyE8nCpDqbnw",
          y: "TeHtcW_YvisEhlbzeI0fUExW63TfPVst6CcfXp4I7cI",
          kid: "4ohPgUXQIA-Lvlq4XxfFdI7VG5dSm1Yo74z4QkYyMCo",
        },
      },
      authorization_endpoint: "eudiw:",
      response_types_supported: ["vp_token"],
      vp_formats_supported: {
        "vc+sd-jwt": {
          "sd-jwt_alg_values": [
            "ES256",
            "ES256K",
            "ES384",
            "ES512",
            "RS256",
            "RS384",
            "RS512",
            "PS256",
            "PS384",
            "PS512",
          ],
        },
        "vp+sd-jwt": {
          "sd-jwt_alg_values": [
            "ES256",
            "ES256K",
            "ES384",
            "ES512",
            "RS256",
            "RS384",
            "RS512",
            "PS256",
            "PS384",
            "PS512",
          ],
        },
      },
      request_object_signing_alg_values_supported: ["ES256"],
      presentation_definition_uri_supported: false,
      iat: 1719303381,
      exp: 1719306981,
    });
  });
});
